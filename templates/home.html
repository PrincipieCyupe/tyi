{% extends 'base.html' %}

{% block title %}
  Home - Tegura Youth Initiative
{% endblock %}

{% block leaderboard %}
  Turn Your Ideas Into Reality
{% endblock %}

{% block text %}
  Access world-class training, connect with mentors, and compete for funding to launch your entrepreneurial journey in Rwanda's fastest-growing startup ecosystem.
{% endblock %}

{% block links %}
  <a href="{{ url_for('opportunities') }}" class="rounded-md bg-indigo-500 px-3.5 py-2.5 text-sm font-semibold text-white shadow-xs hover:bg-indigo-400 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500">
    View Opportunities
  </a>
  <a href="{{ url_for('education') }}" class="text-sm/6 font-semibold text-white">
    Continue learning<span aria-hidden="true">→</span>
  </a>
{% endblock %}

{% block highlight %}
  <a href="{{ url_for('home') }}" class="text-sm/6 font-semibold text-indigo-400">Home</a>
  <a href="{{ url_for('education') }}" class="text-sm/6 font-semibold text-white">Education</a>
  <a href="{{ url_for('opportunities') }}" class="text-sm/6 font-semibold text-white">Opportunities</a>
  <a href="{{ url_for('leaderboard') }}" class="text-sm/6 font-semibold text-white">Leaderboard</a>       
  <a href="{{ url_for('messages') }}" class="text-sm/6 font-semibold text-white">Messages</a>
{% endblock %}

{% block new %}
  <a href="{{ url_for('home') }}" class="-mx-3 block rounded-lg px-3 py-2 text-base/7 font-semibold text-indigo-400 bg-white/5">Home</a>
  <a href="{{ url_for('education') }}" class="-mx-3 block rounded-lg px-3 py-2 text-base/7 font-semibold text-white hover:bg-white/5">Education</a>
  <a href="{{ url_for('opportunities') }}" class="-mx-3 block rounded-lg px-3 py-2 text-base/7 font-semibold text-white hover:bg-white/5">Opportunities</a>
  <a href="{{ url_for('leaderboard') }}" class="-mx-3 block rounded-lg px-3 py-2 text-base/7 font-semibold text-white hover:bg-white/5">Leaderboard</a>
  <a href="{{ url_for('messages') }}" class="-mx-3 block rounded-lg px-3 py-2 text-base/7 font-semibold text-white hover:bg-white/5">Messages</a>
{% endblock %}


{% block body %}

<body class="bg-gray-900">

  <!-- Quick Stats Section -->
  <div class="bg-gray-900 py-24 sm:py-32">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
      <div class="mx-auto max-w-2xl lg:text-center">
        <h2 class="text-base/7 font-semibold text-indigo-400">Your Dashboard</h2>
        <p class="mt-2 text-4xl font-semibold tracking-tight text-pretty text-white sm:text-5xl lg:text-balance">Track your progress at a glance</p>
      </div>
      <div class="mx-auto mt-16 max-w-2xl sm:mt-20 lg:mt-24 lg:max-w-none">
        <dl class="grid max-w-xl grid-cols-1 gap-x-8 gap-y-16 lg:max-w-none lg:grid-cols-4">
          
          <a href="{{ url_for('education') }}" class="flex flex-col bg-gray-800 rounded-3xl p-6 hover:bg-gray-700 transition">
            <dt class="text-base/7 font-semibold text-white">
              <div class="mb-6 flex size-10 items-center justify-center rounded-lg bg-indigo-500">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="size-6 text-white" aria-hidden="true">
                  <path d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              Training Progress
            </dt>
            <dd class="mt-1 flex flex-auto flex-col text-base/7 text-gray-400">
              <p class="flex-auto">{{ overall_progress }}% Complete</p>
              <p class="mt-6">
                <span class="text-3xl font-bold text-white">{{ completed_courses }} of {{ total_courses }}</span>
                <span class="text-sm text-gray-500"> courses</span>
              </p>
            </dd>
          </a>

          <a href="{{ url_for('opportunities') }}" class="flex flex-col bg-gray-800 rounded-3xl p-6 hover:bg-gray-700 transition">
            <dt class="text-base/7 font-semibold text-white">
              <div class="mb-6 flex size-10 items-center justify-center rounded-lg bg-green-500">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="size-6 text-white" aria-hidden="true">
                  <path d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12zm0 3h.008v.008H6.75V15zm0 3h.008v.008H6.75V18z" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              Application Status
            </dt>
            <dd class="mt-1 flex flex-auto flex-col text-base/7 text-gray-400">
              <p class="flex-auto">{{ application.status.replace('_', ' ').title() if application else 'No Application' }}</p>
              <p class="mt-6">
                {% if application %}
                  <span class="inline-flex items-center rounded-full bg-green-500/10 px-3 py-1 text-sm font-semibold text-green-400">Active</span>
                {% else %}
                  <span class="inline-flex items-center rounded-full bg-gray-500/10 px-3 py-1 text-sm font-semibold text-gray-400">None</span>
                {% endif %}
              </p>
            </dd>
          </a>

          <a href="{{ url_for('leaderboard') }}" class="flex flex-col bg-gray-800 rounded-3xl p-6 hover:bg-gray-700 transition">
            <dt class="text-base/7 font-semibold text-white">
              <div class="mb-6 flex size-10 items-center justify-center rounded-lg bg-yellow-500">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="size-6 text-white" aria-hidden="true">
                  <path d="M16.5 18.75h-9m9 0a3 3 0 013 3h-15a3 3 0 013-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 01-.982-3.172M9.497 14.25a7.454 7.454 0 00.981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 007.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 002.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 012.916.52 6.003 6.003 0 01-5.395 4.972m0 0a6.726 6.726 0 01-2.749 1.35m0 0a6.772 6.772 0 01-3.044 0" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              Leaderboard Position
            </dt>
            <dd class="mt-1 flex flex-auto flex-col text-base/7 text-gray-400">
              <p class="flex-auto">{{ 'Rank #' + leaderboard.rank|string if leaderboard else 'Not Ranked' }}</p>
              <p class="mt-6">
                <span class="text-3xl font-bold text-white">{{ leaderboard.total_points if leaderboard else 0 }}</span>
                <span class="text-sm text-gray-500"> points</span>
              </p>
            </dd>
          </a>

          <a href="{{ url_for('messages') }}" class="flex flex-col bg-gray-800 rounded-3xl p-6 hover:bg-gray-700 transition">
            <dt class="text-base/7 font-semibold text-white">
              <div class="mb-6 flex size-10 items-center justify-center rounded-lg bg-blue-500">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="size-6 text-white" aria-hidden="true">
                  <path d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              Messages
            </dt>
            <dd class="mt-1 flex flex-auto flex-col text-base/7 text-gray-400">
              <p class="flex-auto">Unread Notifications</p>
              <p class="mt-6">
                <span class="text-3xl font-bold text-white">{{ unread_messages }}</span>
                <span class="text-sm text-gray-500"> new</span>
              </p>
            </dd>
          </a>

        </dl>
      </div>
    </div>
  </div>

  <!-- Current Training Section -->
  <div class="bg-gray-900 py-24 sm:py-32">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
      <div class="mx-auto max-w-2xl lg:text-center">
        <h2 class="text-base/7 font-semibold text-indigo-400">Your Learning Path</h2>
        <p class="mt-2 text-4xl font-semibold tracking-tight text-pretty text-white sm:text-5xl lg:text-balance">Continue your training</p>
      </div>
      <div class="mx-auto mt-16 max-w-4xl">
        <div class="bg-gray-800 rounded-3xl shadow-lg p-8">
          <div class="flex items-center justify-between mb-6">
            <div>
              {% if user_courses %}
                {% set current_course = user_courses[0] %}
                <h3 class="text-2xl font-semibold text-white">{{ current_course.course.title }}</h3>
                <p class="text-gray-400 mt-1">Module {{ current_course.completed_modules }} of {{ current_course.course.total_modules }} complete</p>
              {% else %}
                <h3 class="text-2xl font-semibold text-white">No Active Courses</h3>
                <p class="text-gray-400 mt-1">Enroll in a course to start learning</p>
              {% endif %}
            </div>
            <span class="text-3xl font-bold text-indigo-400">{{ current_course.progress_percentage if user_courses else 0 }}%</span>
          </div>
          
          <div class="w-full bg-gray-700 rounded-full h-3 mb-6">
            <div class="bg-indigo-500 h-3 rounded-full" style="width: {{ current_course.progress_percentage if user_courses else 0 }}%"></div>
          </div>

          <div class="flex items-center justify-between">
            {% if user_courses %}
              <p class="text-sm text-gray-400">Keep going to complete this course</p>
              <a href="{{ url_for('view_course', course_id=current_course.course_id) }}" class="text-indigo-400 hover:text-indigo-300 font-semibold text-sm flex items-center gap-2">
                Continue Course
                <span aria-hidden="true">→</span>
              </a>
            {% else %}
              <p class="text-sm text-gray-400">Start learning today</p>
              <a href="{{ url_for('education') }}" class="text-indigo-400 hover:text-indigo-300 font-semibold text-sm flex items-center gap-2">
                Browse Courses
                <span aria-hidden="true">→</span>
              </a>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Open Competitions Section -->
  <div class="bg-gray-900 py-24 sm:py-32">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
      <h2 class="text-center text-base font-semibold text-indigo-400">Open Competitions</h2>
      <p class="mx-auto mt-2 max-w-2xl text-center text-4xl font-semibold tracking-tight text-white sm:text-5xl">
        Apply to active competitions
      </p>

      <div class="mt-16 grid grid-cols-1 lg:grid-cols-2 gap-x-8 gap-y-16">
        {% if opportunities %}
          {% for opp in opportunities %}
            <div class="bg-gray-800 rounded-3xl shadow-sm hover:shadow-xl transition overflow-hidden">
              {% if opp.cover_image.startswith('http') %}
                <img src="{{ opp.cover_image }}" alt="{{ opp.title }}" class="w-full h-48 object-cover">
              {% else %}
                <img src="{{ url_for('static', filename='images/' + opp.cover_image) }}" alt="{{ opp.title }}" class="w-full h-48 object-cover">
              {% endif %}
              <div class="p-10">
                <h3 class="text-xl font-semibold text-white mb-2">{{ opp.title }}</h3>
                <p class="text-gray-400 text-sm mb-6">{{ opp.description[:100] }}...</p>
                
                <div class="flex items-center justify-between mb-6">
                  {% if opp.prize_amount %}
                    <div>
                      <p class="text-indigo-400 font-bold text-lg">{{ opp.prize_amount }}</p>
                      <p class="text-gray-500 text-sm">Prize Pool</p>
                    </div>
                  {% endif %}
                  <div class="text-right">
                    <p class="text-white font-semibold">{{ opp.deadline.strftime('%b %d, %Y') }}</p>
                    <p class="text-gray-500 text-sm">Deadline</p>
                  </div>
                </div>

                <a href="{{ url_for('apply_opportunity', opp_id=opp.id) }}" class="block w-full text-center rounded-md bg-indigo-500 px-3.5 py-2.5 text-sm font-semibold text-white shadow-xs hover:bg-indigo-400 transition">
                  Apply Now
                </a>
              </div>
            </div>
          {% endfor %}
        {% else %}
          <div class="col-span-2 bg-gray-800 rounded-3xl p-12 text-center">
            <h3 class="text-xl font-semibold text-white mb-2">No Open Competitions</h3>
            <p class="text-gray-400">Check back soon for new opportunities!</p>
          </div>
        {% endif %}
      </div>

      <div class="mt-10 text-center">
        <a href="{{ url_for('opportunities') }}" class="text-indigo-400 hover:text-indigo-300 font-semibold">View All Competitions <span aria-hidden="true">→</span></a>
      </div>
    </div>
  </div>

  <!-- Upcoming Events Section -->
  <div class="bg-gray-900 py-24 sm:py-32">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
      <h2 class="text-center text-base font-semibold text-indigo-400">Coming Up</h2>
      <p class="mx-auto mt-2 max-w-2xl text-center text-4xl font-semibold tracking-tight text-white sm:text-5xl">
        Upcoming events and deadlines
      </p>

      <div class="mt-16 max-w-4xl mx-auto space-y-8">
        {% if events %}
          {% for event in events %}
            <div class="flex flex-col sm:flex-row sm:justify-between items-start sm:items-center {% if event.event_type == 'deadline' %}bg-red-500/5 border border-red-500/20{% else %}bg-gray-800{% endif %} rounded-3xl p-6 shadow-sm hover:bg-{% if event.event_type == 'deadline' %}red-500/10{% else %}gray-700{% endif %} transition">
              <div class="flex-1">
                <div class="text-white font-semibold text-lg">{{ event.title }}</div>
                <div class="text-gray-400 text-sm mt-1">{{ event.description }}</div>
              </div>
              <div class="text-gray-400 text-sm sm:text-right mt-4 sm:mt-0">
                <div class="{% if event.event_type == 'deadline' %}text-red-400{% else %}text-white{% endif %} font-semibold">{{ event.event_date.strftime('%b %d, %Y') }}</div>
                {% if event.start_time and event.end_time %}
                  <div>{{ event.start_time }} - {{ event.end_time }}</div>
                {% elif event.event_type == 'deadline' %}
                  <div class="text-red-400">Deadline Approaching</div>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        {% else %}
          <div class="bg-gray-800 rounded-3xl p-12 text-center">
            <h3 class="text-xl font-semibold text-white mb-2">No Upcoming Events</h3>
            <p class="text-gray-400">We'll notify you when new events are scheduled.</p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Blog Section -->
  <div class="bg-gray-900 py-24 sm:py-32">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
      <h2 class="text-center text-base font-semibold text-indigo-400">From the Blog</h2>
      <p class="mx-auto mt-2 max-w-2xl text-center text-4xl font-semibold tracking-tight text-white sm:text-5xl">
        Learn how to grow your business
      </p>

      <div class="mt-16 grid grid-cols-1 md:grid-cols-3 gap-8">
        {% if blogs %}
          {% for blog in blogs %}
            <a href="{{ blog.youtube_url }}" target="_blank" class="relative rounded-3xl overflow-hidden shadow-lg hover:shadow-2xl transition">
              {% if blog.cover_image.startswith('http') %}
                <img src="{{ blog.cover_image }}" alt="{{ blog.title }}" class="w-full h-80 object-cover">
              {% else %}
                <img src="{{ url_for('static', filename='images/' + blog.cover_image) }}" alt="{{ blog.title }}" class="w-full h-80 object-cover">
              {% endif %}
              
              <div class="absolute inset-0 bg-black/40 flex flex-col justify-end p-6">
                <p class="text-gray-300 text-sm">{{ blog.publish_date.strftime('%b %d, %Y') }} • {{ blog.author }}</p>
                <h3 class="mt-2 text-white text-xl font-semibold">{{ blog.title }}</h3>
              </div>
            </a>
          {% endfor %}
        {% else %}
          <div class="col-span-3 bg-gray-800 rounded-3xl p-12 text-center">
            <h3 class="text-xl font-semibold text-white mb-2">No Blog Posts Yet</h3>
            <p class="text-gray-400">Check back soon for new content!</p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Recent Activity Section -->
  <div class="bg-gray-900 py-24 sm:py-32">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
      <h2 class="text-center text-base font-semibold text-indigo-400">Recent Updates</h2>
      <p class="mx-auto mt-2 max-w-2xl text-center text-4xl font-semibold tracking-tight text-white sm:text-5xl">
        Stay informed with the latest news
      </p>

      <div class="mt-16 max-w-4xl mx-auto space-y-6">
        {% if activities %}
          {% for activity in activities %}
            <div class="flex items-start gap-4 p-6 bg-gray-800 rounded-3xl hover:bg-gray-700 transition">
              <div class="flex-shrink-0 p-3 bg-{{ activity.icon_color }}-500/10 rounded-lg">
                {% if activity.icon_color == 'green' %}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="size-6 text-green-400" aria-hidden="true">
                    <path d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                {% elif activity.icon_color == 'blue' %}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="size-6 text-blue-400" aria-hidden="true">
                    <path d="M10.34 15.84c-.688-.06-1.386-.09-2.09-.09H7.5a4.5 4.5 0 110-9h.75c.704 0 1.402-.03 2.09-.09m0 9.18c.253.962.584 1.892.985 2.783.247.55.06 1.21-.463 1.511l-.657.38c-.551.318-1.26.117-1.527-.461a20.845 20.845 0 01-1.44-4.282m3.102.069a18.03 18.03 0 01-.59-4.59c0-1.586.205-3.124.59-4.59m0 9.18a23.848 23.848 0 018.835 2.535M10.34 6.66a23.847 23.847 0 008.835-2.535m0 0A23.74 23.74 0 0018.795 3m.38 1.125a23.91 23.91 0 011.014 5.395m-1.014 8.855c-.118.38-.245.754-.38 1.125m.38-1.125a23.91 23.91 0 001.014-5.395m0-3.46c.495.413.811 1.035.811 1.73 0 .695-.316 1.317-.811 1.73m0-3.46a24.347 24.347 0 010 3.46" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                {% elif activity.icon_color == 'purple' %}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="size-6 text-purple-400" aria-hidden="true">
                    <path d="M16.5 18.75h-9m9 0a3 3 0 013 3h-15a3 3 0 013-3m9 0v-3.375c0-.621-.503-1.125-1.125-1.125h-.871M7.5 18.75v-3.375c0-.621.504-1.125 1.125-1.125h.872m5.007 0H9.497m5.007 0a7.454 7.454 0 01-.982-3.172M9.497 14.25a7.454 7.454 0 00.981-3.172M5.25 4.236c-.982.143-1.954.317-2.916.52A6.003 6.003 0 007.73 9.728M5.25 4.236V4.5c0 2.108.966 3.99 2.48 5.228M5.25 4.236V2.721C7.456 2.41 9.71 2.25 12 2.25c2.291 0 4.545.16 6.75.47v1.516M7.73 9.728a6.726 6.726 0 002.748 1.35m8.272-6.842V4.5c0 2.108-.966 3.99-2.48 5.228m2.48-5.492a46.32 46.32 0 012.916.52 6.003 6.003 0 01-5.395 4.972m0 0a6.726 6.726 0 01-2.749 1.35m0 0a6.772 6.772 0 01-3.044 0" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                {% elif activity.icon_color == 'yellow' %}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="size-6 text-yellow-400" aria-hidden="true">
                    <path d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                {% else %}
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="size-6 text-gray-400" aria-hidden="true">
                    <path d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                {% endif %}
              </div>
              <div class="flex-1">
                <h3 class="font-semibold text-white">{{ activity.title }}</h3>
                <p class="text-sm text-gray-400 mt-1">{{ activity.description }}</p>
                <p class="text-xs text-gray-500 mt-2">{{ activity.created_at.strftime('%B %d, %Y') }}</p>
              </div>
            </div>
          {% endfor %}
        {% else %}
          <div class="bg-gray-800 rounded-3xl p-12 text-center">
            <h3 class="text-xl font-semibold text-white mb-2">No Recent Updates</h3>
            <p class="text-gray-400">Check back soon for new announcements!</p>
          </div>
        {% endif %}
      </div>

      <div class="mt-10 text-center">
        <a href="{{ url_for('messages') }}" class="text-indigo-400 hover:text-indigo-300 font-semibold">View All Updates <span aria-hidden="true">→</span></a>
      </div>
    </div>
  </div>
{% endblock %}

</body>
</html>